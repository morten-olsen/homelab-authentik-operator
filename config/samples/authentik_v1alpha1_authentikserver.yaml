apiVersion: authentik.homelab.mortenolsen.pro/v1alpha1
kind: AuthentikServer
metadata:
  labels:
    app.kubernetes.io/name: operator-authentik
    app.kubernetes.io/managed-by: kustomize
  name: main
  namespace: authentik
spec:
  # Reference to secrets containing the PostgreSQL connection details
  postgresHostSecretRef:
    name: postgres-credentials
    key: host
  postgresUserSecretRef:
    name: postgres-credentials
    key: user
  postgresDatabaseSecretRef:
    name: postgres-credentials
    key: name
  postgresPasswordSecretRef:
    name: postgres-credentials
    key: password
  # External hostname for Authentik
  host: auth.example.com
  # Optional: Authentik container image
  # image: ghcr.io/goauthentik/server:latest
  # Optional: Number of replicas
  # replicas: 1
